<!-- templates/serverOverview.html -->
{% extends "base.html" %}

{% block title %}Server Overview{% endblock %}

{% block content %}
<link href="{{ url_for('static', filename='CSS/serverOverview.css') }}" rel="stylesheet">
<div class="container-fluid customContainer mt-3">
  <div class="d-flex">
      <input type="text" class="search-bar w-100" placeholder="Search...">
  </div>
  <div class="tabs">
    <div class="tab active" data-tab="serverdetails">Server Details</div>
    <div class="tab" data-tab="performance">Performance</div>
    <div class="tab" data-tab="network">Network</div>
    <div class="tab" data-tab="cpu&memory">CPU & Memory</div>
    <div class="tab" data-tab="storage">Storage</div>
    <div class="tab" data-tab="health">Health</div>
    <div class="tab" data-tab="templatesettings">Template Settings</div>
  </div>

    <div class="card-content active" id="serverdetails">
    <div class="row  mb-5">
      <div class="col-lg-3">
          <div class="customh2">Server Name:  <input class="custominput" type="text" id="servername" placeholder="Server123"></div>               
      </div>      
      <div class="col-lg-3">
        <div class="customh2">Server Group:  <input class="custominput" type="text" id="servergroup" placeholder="Group123"></div> 
      </div>
      <div class="col-lg-3">
          <div class="customh2">Server Status: Healthy</div>
      </div>
      <div class="col-lg-3 ">
        <div class="customh2">Load Balancing Method: Dynamic + Predictive</div>
      </div>
    </div>
    <div class="row cstmline  mb-5">
      <div class="col-lg-4 mt-2 d-flex justify-content-center">
          <canvas id="cpuUsageChart" class="chart-canvas"></canvas>
      </div>      
      <div class="col-lg-4 mt-2 d-flex justify-content-center">
          <canvas id="memoryUsageChart" class="chart-canvas"></canvas>
      </div>
      <div class="col-lg-4 mt-2 d-flex justify-content-center">
          <canvas id="powerUsageChart" class="chart-canvas"></canvas>
      </div>
    </div>
    <div class="row cstmline mb-5">
      <div class="col-lg-12 mt-2 d-flex justify-content-center">
          <canvas id="trafficTypeChart" class="chart-canvas"></canvas>
      </div>      
  </div>


    </div>
    <div class="card-content" id="performance">
    <div class="row cstmline">
        <div class="col-lg-4 mt-2 d-flex justify-content-center">
            <div class="chart-container" onclick="flipCard(this)">
                <div class="chart-front">
                    <canvas id="requestRateChart"></canvas>
                </div>
                <div class="chart-back">
                    <p>Request Rate measures the number of requests the server handles per second. Spikes may indicate traffic surges or potential issues.</p>
                </div>
            </div>
        </div>
        <div class="col-lg-4 mt-2 d-flex justify-content-center">
            <div class="chart-container" onclick="flipCard(this)">
                <div class="chart-front">
                    <canvas id="responseTimeChart" class="chart-canvas"></canvas>
                </div>
                <div class="chart-back">
                    <p>Response Time measures the average time it takes for the server to respond to requests. High response times may indicate server strain or inefficiencies.</p>
                </div>
            </div>
        </div>
        <div class="col-lg-4 mt-2 ">
            <div class="chart-container" onclick="flipCard(this)">
                <div class="chart-wrapper">
                <div class="chart-front">
                    <canvas id="connectionCountChart" class="chart-canvas"></canvas>
                </div>
                <div class="chart-back">
                    <p>Connection Count displays the number of active connections. A sudden increase could indicate high traffic, while a drop might suggest server issues.</p>
                </div>
            </div>
        </div>
        </div>
    </div>
    <div class="row cstmline">
        <div class="col-lg-6 mt-2 d-flex justify-content-center">
            <div class="chart-container" onclick="flipCard(this)">
                <div class="chart-front">
                    <canvas id="currentLoadChart" class="chart-canvas"></canvas>
                </div>
                <div class="chart-back">
                    <p>Current Load shows the percentage of resources currently being used. High values may indicate that the server is under strain and needs scaling.</p>
                </div>
            </div>
        </div>
        <div class="col-lg-6 mt-2 d-flex justify-content-center">
            <div class="chart-container" onclick="flipCard(this)">
                <div class="chart-front">
                    <canvas id="efficiencyChart" class="chart-canvas"></canvas>
                </div>
                <div class="chart-back">
                    <p>.</p>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div class="card-content" id="network">
            <!-- Row for text elements -->
            <div class="row mb-4 cstmline">
                <div class="col-lg-3">
                    <div class="customh2">IP Address:  <input class="custominput" type="text" id="ipaddress" placeholder="192.168.56.1"></div>               
                </div> 
                <div class="col-lg-3">
                    <div class="customh2">Primary DNS:  <input class="custominput" type="text" id="DNS" placeholder="8.8.8.8"></div>               
                </div> 
                <div class="col-lg-3">
                    <div class="customh2">Subnet Mask:  <input class="custominput" type="text" id="subnetmask" placeholder="255.255.255.0"></div>               
                </div> 
                <div class="col-lg-3">
                    <div class="customh2">Gateway:  <input class="custominput" type="text" id="servername" placeholder="192.168.56.254"></div>               
                </div> 
            </div>
    
            <!-- Rows for charts -->
            <div class="row">
                <div class="col-lg-6 mb-4 customcol">
                    <canvas id="networkChart" ></canvas>
                </div>
                <div class="col-lg-6 mb-4 customcol">
                    <canvas id="latencyChart" ></canvas>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6  mb-4 customcol">
                    <canvas id="packetLossChart" ></canvas>
                </div>
                <div class="col-lg-6  mb-4 customcol">
                    <h6>Bandwidth Utilization</h6>
                    <canvas id="bandwidthUtilizationChart" ></canvas>
                </div>
            </div>
          
    </div>

    <div class="card-content" id="cpu&memory">
        <div class="row mb-4 cstmline">
            <div class="col-lg-3">
                <div class="customh2">CPU Name:  <input class="custominput" type="text" id="cpuname" placeholder="Intel Xeon ..." disabled></div>               
            </div> 
            <div class="col-lg-3">
                <div class="customh2">CPU Speed:  <input class="custominput" type="text" id="cpuspeed" placeholder="2.10 GHz" disabled></div>               
            </div> 
            <div class="col-lg-3">
                <div class="customh2">CPU Cores:  <input class="custominput" type="text" id="cpucores" placeholder="12" disabled></div>               
            </div> 
            <div class="col-lg-3">
                <div class="customh2">CPU Threads:  <input class="custominput" type="text" id="threads" placeholder="24" disabled></div>               
            </div> 
        </div>
        <div class="row mb-4 cstmline">
            <div class="col-lg-3">
                <div class="customh2">Total RAM Installed:  <input class="custominput" type="text" id="raminstalled" placeholder="92 GB" disabled></div>               
            </div> 
            <div class="col-lg-3">
                <div class="customh2">RAM Type:  <input class="custominput" type="text" id="ramtype" placeholder="DDR3" disabled></div>               
            </div> 
            <div class="col-lg-3">
                <div class="customh2">Usable RAM:  <input class="custominput" type="text" id="usableram" placeholder="64 GB" disabled></div>               
            </div> 
            <div class="col-lg-3">
                <div class="customh2">RAM Speed:  <input class="custominput" type="text" id="ramspeed" placeholder="2400 MHz" disabled></div>               
            </div> 
        </div>
        <!-- Rows for charts -->
        <div class="row">
            <div class="col-lg-4 mb-4 customcol">
                <canvas id="cpuChart1"></canvas>
            </div>
            <div class="col-lg-4 mb-4 customcol">
                <canvas id="cpuChart2"></canvas>
            </div>
            <div class="col-lg-4 mb-4 customcol">
                <canvas id="cpuChart3"></canvas>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-4 mb-4 customcol">
                <canvas id="ramChart1"></canvas>
            </div>
            <div class="col-lg-4 mb-4 customcol">
                <canvas id="ramChart2"></canvas>
            </div>
            <div class="col-lg-4 mb-4 customcol">
                <canvas id="ramChart3"></canvas>
            </div>
        </div>
    </div>
  
  <div class="card-content" id="storage">
    <div class="row mb-4 cstmline">
        <div class="col-lg-3">
            <div class="customh2">Disk Types:  <input class="custominput" type="text" id="disktype" placeholder="2 HDD , 3 SSD" disabled></div>               
        </div> 
        <div class="col-lg-3">
            <div class="customh2">Total Capacity:  <input class="custominput" type="text" id="totalcapacity" placeholder="5 TB" disabled></div>               
        </div> 
        <div class="col-lg-3">
            <div class="customh2">Used Space: <input class="custominput" type="text" id="usedspace" placeholder="200GB" disabled></div>               
        </div> 
        <div class="col-lg-3">
            <div class="customh2">Available Space:  <input class="custominput" type="text" id="availablespace" placeholder="4.8 TB" disabled></div>               
        </div> 
    </div>
    <!-- Rows for charts -->
    <div class="row">
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="readInChart"></canvas>
        </div>
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="writeOutChart"></canvas>
        </div>
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="latencyChart2"></canvas>
        </div>
    </div>
     <div class="row">
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="iopsChart"></canvas>
        </div>
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="storageUsageChart"></canvas>
        </div>
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="errorCountChart"></canvas>
        </div>
    </div>
  </div>
  <div class="card-content" id="health">
    <div class="row mb-4 cstmline">
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="systemTemperatureChart"></canvas>
        </div>
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="cpuTemperatureChart"></canvas>
        </div>
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="fanSpeedsChart"></canvas>
        </div>
    </div>
    <div class="row mb-4 cstmline">
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="serverHealthChart"></canvas>
        </div>
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="errorLogChart"></canvas>
        </div>
        <div class="col-lg-4 mb-4 customcol">
            <canvas id="performanceChart"></canvas>
        </div>
    </div>
    <!-- Rows for charts -->
  </div>
  <div class="card-content" id="templatesettings">
<div class="row">
    <div class="col-lg-12 mb-4">
        <div class="table-responsive ">
            <button id="addTemplateBtn" class="addtemplatebtn custombtn buttonstyle mb-3">Add New Template</button>
            <table class="customtable">
                <thead>
                    <tr>
                        <th> <input class="checkboxes" type="checkbox"></th>
                        <th>Template Name</th>
                        <th>Description</th>
                        <th>Applied To</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="templateTableBody">
                 
                </tbody>
            </table>
        </div>
    </div>
</div>
</div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const tableBody = document.getElementById("templateTableBody");
        const addTemplateBtn = document.getElementById("addTemplateBtn");

        // Add new template row
        addTemplateBtn.addEventListener("click", function () {
            const newRow = document.createElement("tr");
            newRow.innerHTML = `
                <td><input class="checkboxes" type="checkbox" disabled></td>
                <td><input type="text" class="custominput" placeholder="Enter template name"></td>
                <td><input type="text" class="custominput" placeholder="Enter description"></td>
                <td>-</td>
                <td>
                    <button class="buttonstyle custombtn createTemplateBtn">Create</button>
                    <button class="buttonstyle custombtn cancelTemplateBtn">Cancel</button>
                </td>
            `;
            tableBody.appendChild(newRow);

            // Handle create and cancel buttons
            newRow.querySelector(".createTemplateBtn").addEventListener("click", function () {
                const nameInput = newRow.querySelector("input[type='text']").value;
                const descInput = newRow.querySelectorAll("input[type='text']")[1].value;

                if (nameInput && descInput) {
                    newRow.innerHTML = `
                        <td><input class="checkboxes" type="checkbox"></td>
                        <td>${nameInput}</td>
                        <td>${descInput}</td>
                        <td>-</td>
                        <td>
                            <button type="button" class="buttonstyle custombtn applyTemplateBtn">Apply Template</button>
                            <button type="button" class="buttonstyle custombtn removeTemplateBtn">Remove</button>
                        </td>
                    `;
                    handleTemplateActions(newRow);
                } else {
                    alert("Please fill out both fields.");
                }
            });

            newRow.querySelector(".cancelTemplateBtn").addEventListener("click", function () {
                newRow.remove();
            });
        });

        // Function to handle actions for each row
        function handleTemplateActions(row) {
            row.querySelector(".applyTemplateBtn").addEventListener("click", function () {
                const applyRow = document.createElement("tr");
                applyRow.classList.add("bg-dark");
                applyRow.innerHTML = `
                    <td colspan="5">
                        <strong>Apply to:</strong>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="server1">
                            <label class="form-check-label" for="server1">Server 1</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="group1">
                            <label class="form-check-label" for="group1">Group A</label>
                        </div>
                        <button class="buttonstyle custombtn apply-confirm-btn">Apply</button>
                        <button class="buttonstyle custombtn  apply-cancel-btn">Cancel</button>
                    </td>
                `;
                row.after(applyRow);

                // Confirm apply action
                applyRow.querySelector(".apply-confirm-btn").addEventListener("click", function () {
                    const appliedToList = [];
                    if (applyRow.querySelector("#server1").checked) appliedToList.push("Server 1");
                    if (applyRow.querySelector("#group1").checked) appliedToList.push("Group A");

                    if (appliedToList.length > 0) {
                        row.cells[3].innerText = appliedToList.join(", ");
                        alert("Template applied successfully!");
                    } else {
                        alert("No selection made.");
                    }
                    applyRow.remove();
                });

                // Cancel apply action
                applyRow.querySelector(".apply-cancel-btn").addEventListener("click", function () {
                    applyRow.remove();
                });
            });

            // Remove button logic
            row.querySelector(".removeTemplateBtn").addEventListener("click", function () {
                if (confirm("Are you sure you want to remove this template?")) {
                    row.remove();
                }
            });
        }
    });
</script>

  <style>
 .chart-container {
    perspective: 1000px;
    width: 100%;
    height: 350px; 
}

.chart-wrapper {
    position: relative;
    width: 100%;
    height: 100%; 
    transform-style: preserve-3d;
    transition: transform 0.6s ease-in-out;
}
.chart-canvas {
    width: 100%; 
    max-height: 300px; /* Ensure no overflow */
}
.col-lg-4, .col-lg-6 {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: auto; 
}
.customcol {
    height: 300px;
}
.chart-front, .chart-back {
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    position: absolute;
    top: 0;
    left: 0;
    display: flex; 
    justify-content: center;
    align-items: center;
    transition: transform 0.6s ease-in-out;
}

.chart-front {
    transform: rotateY(0deg);
    z-index: 2;
}

.chart-back {
    transform: rotateY(180deg);
    background-color: rgba(4, 4, 4, 0.12);
    padding: 20px;
    z-index: 1;
}

.chart-container.flipped .chart-front {
    transform: rotateY(180deg);
}

.chart-container.flipped .chart-back {
    transform: rotateY(0deg);
}
</style>


<script>
function flipCard(container) {
    container.classList.toggle('flipped');
}

   document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', function() {
      // Remove active class from all tabs and all card content sections
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.card-content').forEach(content => content.classList.remove('active'));

      // Add active class to the clicked tab and corresponding content
      this.classList.add('active');
      document.getElementById(this.getAttribute('data-tab')).classList.add('active');
    });
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-streaming"></script>
<script src="https://cdn.jsdelivr.net/npm/date-fns"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
<script>
  
  // Mock data for demonstration purposes
  const labels = ['00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00'];

  const cpuData = {
      labels: labels,
      datasets: [{
          label: 'CPU Usage (%)',
          data: [20, 35, 50, 40, 55, 65, 75],
          borderColor: '#FF6384',
          backgroundColor: 'rgba(255,99,132,0.2)',
          fill: true,
      }]
  };

  const memoryData = {
      labels: labels,
      datasets: [{
          label: 'Memory Usage (%)',
          data: [30, 45, 60, 50, 65, 75, 85],
          borderColor: '#36A2EB',
          backgroundColor: 'rgba(54,162,235,0.2)',
          fill: true,
      }]
  };

  const networkData = {
      labels: labels,
      datasets: [
          {
              label: 'Power Usage (Watt)',
              data: [15, 30, 45, 30, 50, 60, 70],
              borderColor: '#FFCE56',
              backgroundColor: 'rgba(255,206,86,0.2)',
              fill: true,
          }
         
      ]
  };

  const config = (data) => ({
      type: 'line',
      data: data,
      options: {
          responsive: true,
          scales: {
              x: {
                  title: {
                      display: true,
                      text: 'Time (Hours)'
                  }
              },
              y: {
                  title: {
                      display: true,
                      text: 'Usage (%)'
                  },
                  beginAtZero: true,
                  max: 100
              }
          }
      }
  });

  new Chart(document.getElementById('cpuUsageChart').getContext('2d'), config(cpuData));
  new Chart(document.getElementById('memoryUsageChart').getContext('2d'), config(memoryData));
  new Chart(document.getElementById('powerUsageChart').getContext('2d'), config(networkData));


  const trafficTypeData = {
        labels: ['00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00'], // Time intervals
        datasets: [
            {
                label: 'Gaming',
                data: [50, 60, 70, 60, 80, 90, 100], // Mock data
                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                borderColor: 'rgba(255, 99, 132, 1)',
                fill: false
            },
            {
                label: 'VoIP',
                data: [30, 40, 50, 40, 60, 70, 80], // Mock data
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                borderColor: 'rgba(54, 162, 235, 1)',
                fill: false
            },
            {
                label: 'HTTPS',
                data: [100, 110, 120, 110, 130, 140, 150], // Mock data
                backgroundColor: 'rgba(75, 192, 192, 0.5)',
                borderColor: 'rgba(75, 192, 192, 1)',
                fill: false
            },
            {
                label: 'HTTP',
                data: [80, 90, 100, 90, 110, 120, 130], // Mock data
                backgroundColor: 'rgba(153, 102, 255, 0.5)',
                borderColor: 'rgba(153, 102, 255, 1)',
                fill: false
            },
            {
                label: 'FTP',
                data: [20, 30, 40, 30, 50, 60, 70], // Mock data
                backgroundColor: 'rgba(255, 159, 64, 0.5)',
                borderColor: 'rgba(255, 159, 64, 1)',
                fill: false
            }
        ]
    };

    // Configuration for the stacked area chart
    const configchart = {
        type: 'line',
        data: trafficTypeData,
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Network Traffic Types Over Time'
                },
                tooltip: {
                    mode: 'index',
                    intersect: false
                },
                legend: {
                    position: 'top'
                }
            },
            interaction: {
                mode: 'index',
                intersect: false
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Time (Hours)'
                    }
                },
                y: {
                    stacked: true,
                    title: {
                        display: true,
                        text: 'Number of Packets'
                    },
                    beginAtZero: true
                }
            }
        }
    };

    // Render the stacked area chart
    const ctx = document.getElementById('trafficTypeChart').getContext('2d');
    new Chart(ctx, configchart);



    const requestRateData = {
    labels: [],
    datasets: [{
        label: 'Request Rate (requests/sec)',
        data: [],
        borderColor: '#FF5733',
        backgroundColor: 'rgba(255, 87, 51, 0.2)',
        fill: true,
    }]
};

const responseTimeData = {
    labels: [],
    datasets: [{
        label: 'Response Time (ms)',
        data: [],
        borderColor: '#C70039',
        backgroundColor: 'rgba(199, 0, 57, 0.2)',
        fill: true,
    }]
};

const connectionCountData = {
    labels: [],
    datasets: [{
        label: 'Connection Count',
        data: [],
        borderColor: '#900C3F',
        backgroundColor: 'rgba(144, 12, 63, 0.2)',
        fill: true,
    }]
};

const currentLoadData = {
    labels: [],
    datasets: [{
        label: 'Current Load (%)',
        data: [],
        borderColor: '#581845',
        backgroundColor: 'rgba(88, 24, 69, 0.2)',
        fill: true,
    }]
};

const efficiencyData = {
    labels: [],
    datasets: [{
        label: 'Efficiency (MB/s)',
        data: [],
        borderColor: '#2ECC71',
        backgroundColor: 'rgba(46, 204, 113, 0.2)',
        fill: true,
    }]
};

// Function to create real-time chart
const createRealTimeChart = (ctx, data, title) => {
    return new Chart(ctx, {
        type: 'line',
        data: {
            labels: data.labels,
            datasets: [{
                label: title,
                data: data.datasets[0].data,
                borderColor: data.datasets[0].borderColor,
                backgroundColor: data.datasets[0].backgroundColor,
                fill: true,
            }]
        },
        options: {
            responsive: true,
            animation: false, // Disable animation for real-time performance
            scales: {
                x: {
                    type: 'realtime', // Use 'realtime' scale
                    realtime: {
                        duration: 60000, // Display the last 60 seconds of data
                        refresh: 1000, // Refresh data every second
                        delay: 1000, // Delay of 1 second to align with real-time data stream
                        onRefresh: function(chart) {
                            const newData = {
                                x: Date.now(),
                                y: generateRandomData() // Replace with your data fetching function
                            };
                            chart.data.datasets.forEach(dataset => {
                                dataset.data.push(newData);
                            });
                        }
                    },
                    time: {
                        displayFormats: {
                            second: 'HH:mm', // Format for displaying time in HH:mm
                            minute: 'HH:mm', // Optional: to control minute format if needed
                        }
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: 'Metrics'
                    },
                    beginAtZero: true
                }
            }
        }
    });
};

// Replace generateRandomData() with a function that fetches or simulates real-time data
function generateRandomData() {
    return Math.floor(Math.random() * 1000); // Example: random value between 0-100
}

// Create charts
createRealTimeChart(document.getElementById('requestRateChart').getContext('2d'), requestRateData, 'Request Rate');
createRealTimeChart(document.getElementById('responseTimeChart').getContext('2d'), responseTimeData, 'Response Time');
createRealTimeChart(document.getElementById('connectionCountChart').getContext('2d'), connectionCountData, 'Connection Count');
createRealTimeChart(document.getElementById('currentLoadChart').getContext('2d'), currentLoadData, 'Current Load');
createRealTimeChart(document.getElementById('efficiencyChart').getContext('2d'), efficiencyData, 'Efficiency');
    
</script>
<script>
    // Function to generate random data for mock purposes
    function getRandomData(maxValue) {
        return Math.floor(Math.random() * maxValue);
    }

    // Function to create a real-time chart
    function createChart(ctx, labels, datasetOptions) {
        return new Chart(ctx, {
            type: 'line',
            data: {
                datasets: datasetOptions
            },
            options: {
                responsive: true,
                plugins: {
                    streaming: {
                        frameRate: 30 // Adjust frame rate as needed
                    }
                },
                scales: {
                    x: {
                        type: 'realtime',
                        realtime: {
                            duration: 20000, // Display data for the last 20 seconds
                            refresh: 1000,   // Refresh data every second
                            delay: 1000,     // Delay of 1 second
                            onRefresh: function(chart) {
                                chart.data.datasets.forEach(function(dataset) {
                                    dataset.data.push({
                                        x: Date.now(),
                                        y: getRandomData(100) // Add random data for each dataset
                                    });
                                });
                            }
                        }
                    },
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    }

    // Wait for the DOM to load
    document.addEventListener('DOMContentLoaded', () => {
        // Create the combined "Network In/Out" chart
        const networkChartCtx = document.getElementById('networkChart').getContext('2d');
        createChart(networkChartCtx, ['Network In', 'Network Out'], [
            {
                label: 'Network In',
                borderColor: 'rgba(75, 192, 192, 1)',
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                data: [] // Data for "Network In"
            },
            {
                label: 'Network Out',
                borderColor: 'rgba(255, 99, 132, 1)',
                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                data: [] // Data for "Network Out"
            }
        ]);

        // Create the "Latency" chart
        const latencyChartCtx = document.getElementById('latencyChart').getContext('2d');
        createChart(latencyChartCtx, ['Latency'], [
            {
                label: 'Latency',
                borderColor: 'rgba(153, 102, 255, 1)',
                backgroundColor: 'rgba(153, 102, 255, 0.2)',
                data: [] // Data for "Latency"
            }
        ]);

        // Create the "Packet Loss" chart
        const packetLossChartCtx = document.getElementById('packetLossChart').getContext('2d');
        createChart(packetLossChartCtx, ['Packet Loss'], [
            {
                label: 'Packet Loss',
                borderColor: 'rgba(255, 159, 64, 1)',
                backgroundColor: 'rgba(255, 159, 64, 0.2)',
                data: [] // Data for "Packet Loss"
            }
        ]);

        // Create the "Bandwidth Utilization" chart
        const bandwidthUtilizationChartCtx = document.getElementById('bandwidthUtilizationChart').getContext('2d');
        createChart(bandwidthUtilizationChartCtx, ['Bandwidth Utilization'], [
            {
                label: 'Bandwidth Utilization',
                borderColor: 'rgba(54, 162, 235, 1)',
                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                data: [] // Data for "Bandwidth Utilization"
            }
        ]);
    });
</script>

<script>
    function createStreamingChart(ctx, label) {
        return new Chart(ctx, {
            type: 'line',
            data: {
                datasets: [{
                    label: label,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    fill: true,
                    data: []
                }]
            },
            options: {
                responsive: true,
                animation: false,
                scales: {
                    x: {
                        type: 'realtime',
                        realtime: {
                            delay: 2000,
                            refresh: 1000,
                            onRefresh: function(chart) {
                                chart.data.datasets.forEach(function(dataset) {
                                    dataset.data.push({
                                        x: Date.now(),
                                        y: Math.floor(Math.random() * 100)
                                    });
                                });
                            }
                        }, time: {
                        displayFormats: {
                            second: 'HH:mm', // Format for displaying time in HH:mm
                            minute: 'HH:mm', // Optional: to control minute format if needed
                        }
                    }
                    },
                    y: {
                        beginAtZero: true,
                        max: 100
                    }
                }
            }
        });
    }

    // Create CPU charts
    createStreamingChart(document.getElementById('cpuChart1').getContext('2d'), 'CPU Utilization Over Time (%)');
    createStreamingChart(document.getElementById('cpuChart2').getContext('2d'), 'Core Usage (%)');
    createStreamingChart(document.getElementById('cpuChart3').getContext('2d'), 'Clock Speed Over Time (GHz)');

    // Create RAM charts
    createStreamingChart(document.getElementById('ramChart1').getContext('2d'), 'Memory Utilization (MB)');
    createStreamingChart(document.getElementById('ramChart2').getContext('2d'), 'Cache Utilization (MB)');
    createStreamingChart(document.getElementById('ramChart3').getContext('2d'), 'Memory Swapping (MB)');
</script>
<script>
    // Initialize charts for Read In, Write Out, and Latency
    const readInCtx = document.getElementById('readInChart').getContext('2d');
    const writeOutCtx = document.getElementById('writeOutChart').getContext('2d');
    const latencyCtx = document.getElementById('latencyChart2').getContext('2d');

    const createCharts = (context, label) => {
        return new Chart(context, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: label,
                    data: [],
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2,
                    fill: false,
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        type: 'realtime',
                        realtime: {
                            duration: 20000,
                            refresh: 1000,
                            delay: 1000,
                            onRefresh: function(chart) {
                                if (chart.data && chart.data.datasets) {
                                    chart.data.labels.push(Date.now());
                                    chart.data.datasets.forEach(function(dataset) {
                                        dataset.data.push({
                                            x: Date.now(),
                                            y: Math.random() * 100 // Replace with real data source
                                        });
                                    });
                                }
                            }
                        }
                    },
                    y: {
                        beginAtZero: true
                    }
                },
                plugins: {
                    legend: {
                        display: true
                    }
                }
            }
        });
    };

    const readInChart = createCharts(readInCtx, 'Read In');
    const writeOutChart = createCharts(writeOutCtx, 'Write Out');
    const latencyChart2 = createCharts(latencyCtx, 'Latency');

    // Initialize charts for IOPS, Storage Capacity Usage Over Time, and Error Count Accumulated Daily
    const iopsCtx = document.getElementById('iopsChart').getContext('2d');
    const storageUsageCtx = document.getElementById('storageUsageChart').getContext('2d');
    const errorCountCtx = document.getElementById('errorCountChart').getContext('2d');

    const iopsChart = createCharts(iopsCtx, 'IOPS');
    const storageUsageChart = createCharts(storageUsageCtx, 'Storage Capacity Usage Over Time');
    const errorCountChart = createCharts(errorCountCtx, 'Error Count Accumulated Daily');
</script>
<script>
    // 1. System Temperature Chart
    const systemTemperatureData = {
        labels: ['10:00', '11:00', '12:00', '13:00', '14:00', '15:00'],
        datasets: [{
            label: 'System Temperature (°C)',
            data: [55, 56, 57, 56, 54, 55],
            borderColor: 'rgba(255, 99, 132, 1)',
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            fill: false
        }]
    };
    const systemTemperatureCtx = document.getElementById('systemTemperatureChart').getContext('2d');
    new Chart(systemTemperatureCtx, {
        type: 'line',
        data: systemTemperatureData,
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'System Temperature Over Time'
                }
            }
        }
    });

    // 2. CPU Temperature Chart
    const cpuTemperatureData = {
        labels: ['10:00', '11:00', '12:00', '13:00', '14:00', '15:00'],
        datasets: [{
            label: 'CPU Temperature (°C)',
            data: [65, 67, 66, 68, 67, 66],
            borderColor: 'rgba(54, 162, 235, 1)',
            backgroundColor: 'rgba(54, 162, 235, 0.2)',
            fill: false
        }]
    };
    const cpuTemperatureCtx = document.getElementById('cpuTemperatureChart').getContext('2d');
    new Chart(cpuTemperatureCtx, {
        type: 'line',
        data: cpuTemperatureData,
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'CPU Temperature Over Time'
                }
            }
        }
    });

    // 3. Fan Speeds Chart
    const fanSpeedsData = {
        labels: ['Fan 1', 'Fan 2', 'Fan 3', 'Fan 4'],
        datasets: [{
            label: 'Fan Speed (RPM)',
            data: [1200, 1500, 1400, 1300],
            backgroundColor: [
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)',
                'rgba(255, 205, 86, 0.2)'
            ],
            borderColor: [
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)',
                'rgba(255, 205, 86, 1)'
            ],
            borderWidth: 1
        }]
    };
    const fanSpeedsCtx = document.getElementById('fanSpeedsChart').getContext('2d');
    new Chart(fanSpeedsCtx, {
        type: 'bar',
        data: fanSpeedsData,
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'Fan Speeds'
                }
            }
        }
    });

    // 4. Server Health Chart
    const serverHealthData = {
        labels: ['10:00', '11:00', '12:00', '13:00', '14:00', '15:00'],
        datasets: [{
            label: 'Server Health Score',
            data: [90, 85, 88, 87, 89, 90],
            borderColor: 'rgba(255, 206, 86, 1)',
            backgroundColor: 'rgba(255, 206, 86, 0.2)',
            fill: false
        }]
    };
    const serverHealthCtx = document.getElementById('serverHealthChart').getContext('2d');
    new Chart(serverHealthCtx, {
        type: 'line',
        data: serverHealthData,
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'Server Health Over Time'
                }
            }
        }
    });

    // 5. Error Log Chart
    const errorLogData = {
        labels: ['10:00', '11:00', '12:00', '13:00', '14:00', '15:00'],
        datasets: [{
            label: 'Number of Errors',
            data: [2, 1, 3, 0, 1, 2],
            borderColor: 'rgba(153, 102, 255, 1)',
            backgroundColor: 'rgba(153, 102, 255, 0.2)',
            fill: false
        }]
    };
    const errorLogCtx = document.getElementById('errorLogChart').getContext('2d');
    new Chart(errorLogCtx, {
        type: 'line',
        data: errorLogData,
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'Errors Logged Over Time'
                }
            }
        }
    });

    // 6. Performance Chart
    const performanceData = {
        labels: ['10:00', '11:00', '12:00', '13:00', '14:00', '15:00'],
        datasets: [{
            label: 'Performance (%)',
            data: [75, 80, 78, 82, 81, 79],
            borderColor: 'rgba(54, 162, 235, 1)',
            backgroundColor: 'rgba(54, 162, 235, 0.2)',
            fill: false
        }]
    };
    const performanceCtx = document.getElementById('performanceChart').getContext('2d');
    new Chart(performanceCtx, {
        type: 'line',
        data: performanceData,
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'Performance Over Time'
                }
            }
        }
    });
</script>

{% endblock %}